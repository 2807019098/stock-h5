# 筛选功能实现说明

## 功能概述

根据参考网站 [http://stockpc.zhikaisoft.cn/](http://stockpc.zhikaisoft.cn/) 的筛选条件，实现了完整的股票筛选功能。

## 筛选条件

### 1. 盈利筛选

- 使用复选框组件实现
- 可选择：盈利、亏损
- 支持多选

### 2. 大X日筛选

- 使用复选框组件实现
- 可选择：大1日、大2日、大3日、大5日
- 支持多选

### 3. 涨跌幅度筛选

- 使用滑动变阻器实现
- 范围：0% - 30%
- 步长：5%
- 实时显示当前值

## 排序条件

### 1. 排序方式

- 使用单选按钮实现
- 选项：前误差、1日涨跌、2日涨跌、X日涨跌

### 2. 排序方向

- 使用单选按钮实现
- 选项：升序、降序

## 技术实现

### 组件结构

```
HeadMenu.vue (布局容器)
├── SidebarMenu.vue (侧边栏菜单)
│   └── ScreenPannel.vue (筛选面板)
└── home/index.vue (主页内容)
```

### 数据流

1. 用户在筛选面板中设置条件
2. ScreenPannel 组件使用 Pinia 状态管理
3. 筛选条件持久化存储在 Pinia store 中
4. home 组件直接从 store 获取筛选条件
5. 筛选面板关闭后条件不会清空

### API 参数映射

```javascript
// 筛选参数映射
const payload = {
  sortField: sortFieldMap[sortType], // 排序字段映射
  sortAsc: sortOrder === 'asc' ? '1' : '0', // 排序方向
  yili: profit.includes('profit') ? '1' : profit.includes('loss') ? '0' : '', // 盈利筛选
  dax: bigDays.join(','), // 大X日筛选
  xianzhi: changeRange.toString() // 涨跌幅度筛选
};

// 排序字段映射表
const sortFieldMap = {
  fronterror: 'day1Dif', // 前误差
  '1day': 'day1_2', // 1日涨跌
  '2day': 'day2_1', // 2日涨跌
  xday: 'xdayb' // X日涨跌
};
```

## 样式特点

### 1. 主题适配

- 支持浅色/深色主题切换
- 使用CSS变量实现主题色彩统一
- 所有Vant组件都进行了主题适配

### 2. 响应式设计

- 移动端优先设计
- 支持PC端适配
- 弹窗宽度自适应

### 3. 用户体验

- 筛选面板从右侧滑出
- 支持重置和应用操作
- 实时预览筛选条件

## 使用方法

1. 点击右上角的筛选按钮（漏斗图标）
2. 在筛选面板中设置筛选条件
3. 点击"应用筛选"按钮应用条件
4. 点击"重置"按钮清除所有条件

## 重置功能

### 重置操作流程

1. 点击筛选面板中的"重置"按钮
2. 系统自动清空所有筛选条件
3. 立即应用重置后的条件
4. 重新加载股票列表数据
5. 更新状态指示器显示

### 重置功能特点

- **即时生效**: 重置后立即应用，无需手动确认
- **数据同步**: 自动重新加载股票列表
- **状态更新**: 状态指示器实时更新
- **全局响应**: 所有相关组件都会响应重置操作

## 状态管理

### Pinia Store

- **文件位置**: `src/store/filter.ts`
- **功能**: 持久化筛选条件状态
- **优势**: 筛选面板关闭后条件不会清空

### 主要方法

- `updateFilter(data)`: 更新筛选条件
- `resetFilter()`: 重置所有筛选条件
- `getFilterData()`: 获取当前筛选条件
- `hasActiveFilters()`: 检查是否有活跃的筛选条件
- `getFilterSummary()`: 获取筛选条件摘要

## 注意事项

1. 筛选条件会立即应用到股票列表
2. 筛选后会自动重置分页，重新加载数据
3. 筛选面板支持主题切换
4. 所有筛选条件都支持组合使用
5. **筛选条件持久化**: 关闭面板后条件不会清空
6. **状态指示器**: 面板头部显示"已应用筛选"状态
7. **完善的重置功能**: 重置后立即应用并重新加载数据
8. **全局事件通信**: 支持跨组件的重置事件处理
